

wlst_name = '/ResourceGroups/'

m = ls(wlst_name, returnMap='true')

f = open_file("name;resource_group_template;virtual_target")
for token in m:
    print '___'+token+'___'
    cd(wlst_name + token)

    resourceGroupTemplateMbean = cmo.getResourceGroupTemplate()
    if resourceGroupTemplateMbean:
        path = getPath(resourceGroupTemplateMbean)
        cd('/' + path)
        resource_group_template = get('Name')
        cd(wlst_name + token)
    else:
        resource_group_template = ''

    target, targetType = retrieve_target_list('/ResourceGroups/'+token)
    if target:
        virtual_target = target[0]
    else:
        virtual_target = ''

    add_index_entry(f, [domain+'/'+token, resource_group_template, virtual_target])

f.close()
report_back_success()

