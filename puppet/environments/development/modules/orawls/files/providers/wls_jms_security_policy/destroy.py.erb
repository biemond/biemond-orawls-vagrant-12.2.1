from weblogic.security.service import JMSResource

# check the domain else we need to skip this (done in wls_access.rb)
real_domain='<%= domain %>'


authorizationprovider = '<%= authorizationprovider %>'
jmsmodule             = '<%= jmsmodule %>'
destinationtype       = '<%= destinationtype %>'
resourcename          = '<%= resourcename %>'
action                = '<%= action %>'

if action == 'all':
  actionname = None
else:
  actionname = action

try:
    cd('/')
    securityRealm = cmo.getSecurityConfiguration().getDefaultRealm()
    authorizer = securityRealm.lookupAuthorizer(authorizationprovider)
    resource = weblogic.security.service.JMSResource(jmsmodule, destinationtype, resourcename, actionname)
    resourceId = resource.toString()
    authorizer.removePolicy(resourceId)

    print "~~~~COMMAND SUCCESFULL~~~~"

except:
    print "Unexpected error:", sys.exc_info()[0]
    print "~~~~COMMAND FAILED~~~~"
    raise
