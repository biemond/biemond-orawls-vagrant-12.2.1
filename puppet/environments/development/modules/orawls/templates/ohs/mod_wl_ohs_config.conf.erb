# NOTE: This is a template to configure mod_weblogic, generated by Puppet.

<% unless @rewrites.nil? || @rewrites.empty? %>
<IfModule mod_rewrite>
  RewriteEngine on

  <% @rewrites.each do |from, rewrite| -%>
  RewriteRule <%= from %> <%= rewrite['to'] %> <%= (rewrite['options'].nil? || rewrite['options'].empty?) ? '' : "[#{rewrite['options']}]" %>
  <% end -%>
</IfModule>
<% end %>

<% unless @locations.nil? || @locations.empty? %>
<IfModule weblogic_module>
<% @locations.each do |location, servers| %>
<LocationMatch "<%= location %>">
  SetHandler weblogic-handler

  <% if servers.size == 1 %>
  WebLogicHost <%= servers[0].split(/:/).first %>
  WebLogicPort <%= servers[0].split(/:/).last %>
  <% else %>
  WebLogicCluster <%= servers.map { |item| "#{item.split(/:/).first}:#{item.split(/:/).last}" }.join ',' %>
  <% end %>
</LocationMatch>
<% end %>
</IfModule>
<% end %>